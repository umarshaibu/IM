<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <title>@ViewData["Title"] - IM Admin</title>

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <!-- Bootstrap Icons -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" rel="stylesheet" />

    <!-- Custom Metronic-inspired styles -->
    <link href="/css/admin.css" rel="stylesheet" />
</head>
<body id="kt_body" class="header-fixed header-tablet-and-mobile-fixed aside-fixed">
    @if (User.Identity?.IsAuthenticated == true)
    {
        <div class="d-flex flex-column flex-root">
            <div class="page d-flex flex-row flex-column-fluid">
                <!-- Sidebar -->
                <div id="kt_aside" class="aside">
                    <!-- Logo -->
                    <div class="aside-logo d-flex align-items-center px-5 pt-6 pb-4">
                        <a href="/admin" class="d-flex align-items-center text-decoration-none">
                            <span class="aside-logo-icon">
                                <i class="bi bi-chat-square-dots-fill"></i>
                            </span>
                            <span class="aside-logo-text ms-3">IM Admin</span>
                        </a>
                    </div>

                    <!-- Menu -->
                    <div class="aside-menu flex-column-fluid px-3 py-4">
                        <div class="menu menu-column">
                            <!-- Dashboard -->
                            <div class="menu-item mb-1">
                                <a class="menu-link @(ViewData["ActivePage"]?.ToString() == "Dashboard" ? "active" : "")" href="/admin">
                                    <span class="menu-icon">
                                        <i class="bi bi-grid"></i>
                                    </span>
                                    <span class="menu-title">Dashboard</span>
                                </a>
                            </div>

                            <!-- Separator -->
                            <div class="menu-item">
                                <div class="menu-content pt-5 pb-2">
                                    <span class="menu-section text-uppercase fs-8 ls-1">User Management</span>
                                </div>
                            </div>

                            <div class="menu-item mb-1">
                                <a class="menu-link @(ViewData["ActivePage"]?.ToString() == "Users" ? "active" : "")" href="/admin/users">
                                    <span class="menu-icon">
                                        <i class="bi bi-people"></i>
                                    </span>
                                    <span class="menu-title">Users</span>
                                </a>
                            </div>

                            <div class="menu-item mb-1">
                                <a class="menu-link @(ViewData["ActivePage"]?.ToString() == "NominalRoll" ? "active" : "")" href="/admin/nominal-roll">
                                    <span class="menu-icon">
                                        <i class="bi bi-person-lines-fill"></i>
                                    </span>
                                    <span class="menu-title">Nominal Roll</span>
                                </a>
                            </div>

                            <!-- Separator -->
                            <div class="menu-item">
                                <div class="menu-content pt-5 pb-2">
                                    <span class="menu-section text-uppercase fs-8 ls-1">Content</span>
                                </div>
                            </div>

                            <div class="menu-item mb-1">
                                <a class="menu-link @(ViewData["ActivePage"]?.ToString() == "Channels" ? "active" : "")" href="/admin/channels">
                                    <span class="menu-icon">
                                        <i class="bi bi-broadcast"></i>
                                    </span>
                                    <span class="menu-title">Channels</span>
                                </a>
                            </div>

                            <div class="menu-item mb-1">
                                <a class="menu-link @(ViewData["ActivePage"]?.ToString() == "Broadcast" ? "active" : "")" href="/admin/broadcast">
                                    <span class="menu-icon">
                                        <i class="bi bi-megaphone"></i>
                                    </span>
                                    <span class="menu-title">Broadcast</span>
                                </a>
                            </div>
                        </div>
                    </div>

                    <!-- Footer -->
                    <div class="aside-footer d-flex flex-column align-items-center px-5 pb-5">
                        <a href="/admin/logout" class="btn btn-custom btn-logout w-100">
                            <i class="bi bi-box-arrow-left me-2"></i>
                            Sign Out
                        </a>
                    </div>
                </div>

                <!-- Wrapper -->
                <div class="wrapper d-flex flex-column flex-row-fluid">
                    <!-- Header -->
                    <div id="kt_header" class="header">
                        <div class="container-fluid d-flex align-items-center justify-content-between h-100">
                            <!-- Mobile Toggle -->
                            <div class="d-flex align-items-center d-lg-none">
                                <button class="btn btn-icon btn-active-icon-primary" id="kt_aside_toggle">
                                    <i class="bi bi-list fs-1"></i>
                                </button>
                            </div>

                            <!-- Page Title -->
                            <div class="page-title d-none d-lg-flex flex-column align-items-start justify-content-center">
                                <h1 class="page-heading d-flex text-dark fw-bold fs-3 my-0">@ViewData["Title"]</h1>
                                <ul class="breadcrumb breadcrumb-separatorless fw-semibold fs-7 my-0 pt-1">
                                    <li class="breadcrumb-item text-muted">
                                        <a href="/admin" class="text-muted text-hover-primary">Home</a>
                                    </li>
                                    <li class="breadcrumb-item">
                                        <span class="bullet bg-gray-400 w-5px h-2px mx-2"></span>
                                    </li>
                                    <li class="breadcrumb-item text-muted">@ViewData["Title"]</li>
                                </ul>
                            </div>

                            <!-- Toolbar -->
                            <div class="d-flex align-items-center">
                                <div class="d-flex align-items-center">
                                    <div class="symbol symbol-40px">
                                        <div class="symbol-label fs-5 fw-bold bg-primary text-white">
                                            @User.Identity?.Name?.Substring(0, 1).ToUpper()
                                        </div>
                                    </div>
                                    <div class="d-none d-md-flex flex-column ms-3">
                                        <span class="text-gray-900 fs-6 fw-bold">@User.Identity?.Name</span>
                                        <span class="text-gray-500 fs-7">Administrator</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Content -->
                    <div class="content d-flex flex-column flex-column-fluid">
                        <div class="container-fluid py-5">
                            @if (TempData["Success"] != null)
                            {
                                <div class="alert alert-success d-flex align-items-center p-5 mb-6">
                                    <i class="bi bi-check-circle-fill fs-2hx text-success me-4"></i>
                                    <div class="d-flex flex-column">
                                        <span class="fw-semibold fs-6">@TempData["Success"]</span>
                                    </div>
                                    <button type="button" class="btn-close position-absolute end-0 me-4" data-bs-dismiss="alert"></button>
                                </div>
                            }
                            @if (TempData["Error"] != null)
                            {
                                <div class="alert alert-danger d-flex align-items-center p-5 mb-6">
                                    <i class="bi bi-exclamation-triangle-fill fs-2hx text-danger me-4"></i>
                                    <div class="d-flex flex-column">
                                        <span class="fw-semibold fs-6">@TempData["Error"]</span>
                                    </div>
                                    <button type="button" class="btn-close position-absolute end-0 me-4" data-bs-dismiss="alert"></button>
                                </div>
                            }
                            @RenderBody()
                        </div>
                    </div>

                    <!-- Footer -->
                    <div class="footer py-4 d-flex flex-column flex-md-row align-items-center justify-content-center">
                        <div class="text-gray-500 text-center">
                            <span class="text-muted fw-semibold me-1">&copy; @DateTime.Now.Year</span>
                            <span class="text-gray-800">IM Admin Panel</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Mobile Sidebar Overlay -->
        <div class="aside-overlay" id="kt_aside_overlay"></div>
    }
    else
    {
        @RenderBody()
    }

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
    <script src="/js/admin.js"></script>
    @await RenderSectionAsync("Scripts", required: false)
</body>
</html>
